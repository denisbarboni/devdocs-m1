<!DOCTYPE html>
<html lang="en" dir="ltr" class="spectrum spectrum--medium spectrum--lightest">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<title>Configure declarative schema | Magento 2 Developer Documentation</title>
	<meta name="description" content="Magento 2 Developer Documentation.">

	<link rel="stylesheet" href="https://use.typekit.net/iaw1apr.css">
	<link rel="stylesheet" href="https://devdocs.magento.com/assets/css/app.css?ver=10" />
	<link rel="stylesheet" href="https://devdocs.magento.com/assets/css/print.css?ver=10" media="print"/>

	<link rel="stylesheet" href="https://devdocs.magento.com/common/css/devdocs.css" />
<link rel="alternate" type="application/rss+xml" title="Magento DevDocs RSS" href="https://devdocs.magento.com/feed.xml" />


<link rel="canonical" href="db-schema.html" data-proofer-ignore />


<meta name="google-site-verification" content="3WFsoYwBe6UuxDwgs7bmd7t0YFQVzDpLpWLjNh0CUp8" />

	<script>
  var baseUrl = "";
  var algolia = {
    id : "E642SEDTHL",
    index:  "devdocs",
    key:  "d2d0f33ab73e291ef8d88d8b565e754c",
  };

  var indices = [
    {
      label: "DevDocs",
      name: "devdocs",
      facetFilters: [["guide_version: 2.4", "versionless: true"]],
      refinements: [
        {
          label: "Functional areas",
          attribute: "functional_areas"
        }
      ],
      baseUrl: "https://devdocs.magento.com"
    },
    {
      label: "User Guide",
      name: "merchdocs",
      baseUrl: "https://docs.magento.com/user-guide"
    },
    {
      label: "MBI User Guide",
      name: "merchdocs-mbi",
      baseUrl: "https://docs.magento.com/mbi"
    },
    {
      label: "PWA",
      name: "pwa-devdocs",
      baseUrl: "https://magento.github.io/pwa-studio"
    },
    {
      label: "Order Management",
      name: "oms-en",
      baseUrl: "https://omsdocs.magento.com"
    }
  ];
</script>



<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-KRCLXBB');</script>
<!-- End Google Tag Manager -->

<script src="https://assets.adobedtm.com/98fab992275ef6366cc65f57f86b1e895a66c912/satelliteLib-f90f1129109ea4b2101512675a2769865aa7ea5b.js"></script>




	<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="https://magento.com/favicon.ico">
	<link rel="apple-touch-icon" type="image/png" href="https://magento.com/apple-touch-icon.png">
	<link rel="apple-touch-icon" type="image/png" sizes="57x57" href="https://magento.com/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon" type="image/png" sizes="72x72" href="https://magento.com/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://magento.com/apple-touch-icon-76x76.png">
	<link rel="apple-touch-icon" type="image/png" sizes="114x114" href="https://magento.com/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://magento.com/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" type="image/png" sizes="144x144" href="https://magento.com/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://magento.com/apple-touch-icon-152x152.png">
	<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://magento.com/apple-touch-icon-180x180.png">

</head>
<body class="layout-default">

	<header class="site-header">

		
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KRCLXBB"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->


<nav class="site-nav">

  <div class="nav-container">

    <div class="menu-btn">
      <button id="menu-btn" class="menu-trigger menu-icon" aria-haspopup="true" aria-controls="nav-main" aria-label="Menu"></button>
    </div>

    <a class="logo" href="https://devdocs.magento.com/">
      <img class="logo-image" src="https://devdocs.magento.com/assets/i/adobe-a.svg" alt="Adobe">
      <span class="logo-text">Magento</span>
      <span class="site-logo">DevDocs</span>
    </a>

    <div id="nav-main" class="nav-main-wrap" aria-labelledby="menu-btn">
      <!-- Main Navigation --><ul class="nav-main spectrum-Tabs spectrum-Tabs--horizontal" role="menubar"><li class="nav-main-item spectrum-Tabs-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span class="spectrum-Tabs-itemLabel" tabindex="-1">Cloud</span><div class="nav-popup spectrum-Popover"><div class="nav-section">
              <div class="spectrum-Menu-sectionHeading">Cloud basics</div>
              <ul class="spectrum-Menu"><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/cloud/bk-cloud.html" class="spectrum-Menu-itemLabel ">Cloud Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/cloud/architecture/cloud-architecture.html" class="spectrum-Menu-itemLabel ">Cloud Architecture</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/cloud/project/project-start.html" class="spectrum-Menu-itemLabel ">Project Structure</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/cloud/project/project-upgrade-parent.html" class="spectrum-Menu-itemLabel ">Upgrades and Patches</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/cloud/release-notes/cloud-tools.html" class="spectrum-Menu-itemLabel ">Release Notes</a></li></ul>
            </div><div class="nav-section">
              <div class="spectrum-Menu-sectionHeading">Cloud development</div>
              <ul class="spectrum-Menu"><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/cloud/docker/docker-development.html" class="spectrum-Menu-itemLabel ">Local development</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/cloud/docker/docker-config.html" class="spectrum-Menu-itemLabel ">Configure and launch Docker</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/cloud/docker/docker-quick-reference.html" class="spectrum-Menu-itemLabel ">Docker quick reference</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/cloud/project/project-conf-files_magento-app.html" class="spectrum-Menu-itemLabel ">Configure Application</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/cloud/env/environments.html" class="spectrum-Menu-itemLabel ">Configure Environments</a></li></ul>
            </div><div class="nav-section">
              <div class="spectrum-Menu-sectionHeading">Functional Testing</div>
              <ul class="spectrum-Menu"><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/cloud/docker/docker-mftf.html" class="spectrum-Menu-itemLabel ">Magento application testing</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/cloud/docker/docker-test-magecloud-pkg-code.html" class="spectrum-Menu-itemLabel ">Magento Cloud code testing</a></li></ul>
            </div></div></li><li class="nav-main-item spectrum-Tabs-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span class="spectrum-Tabs-itemLabel" tabindex="-1">Setup</span><div class="nav-popup spectrum-Popover"><ul><li class="  spectrum-Menu-item" role="menuitem"><a href="../../install-gde/bk-install-guide.html" class="spectrum-Menu-itemLabel ">Installation Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/extensions/" class="spectrum-Menu-itemLabel ">Magento Extensions Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../comp-mgr/bk-compman-upgrade-guide.html" class="spectrum-Menu-itemLabel ">Software Update Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../config-guide/bk-config-guide.html" class="spectrum-Menu-itemLabel ">Configuration Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../performance-best-practices/introduction.html" class="spectrum-Menu-itemLabel ">Performance Best Practices</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../migration/bk-migration-guide.html" class="spectrum-Menu-itemLabel ">Migration Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../release-notes/bk-release-notes.html" class="spectrum-Menu-itemLabel ">Release Information</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../reference/cli/magento.html" class="spectrum-Menu-itemLabel ">Command-line Tools Reference</a></li></ul></div></li><li class="nav-main-item spectrum-Tabs-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span class="spectrum-Tabs-itemLabel" tabindex="-1">Development</span><div class="nav-popup spectrum-Popover"><div class="nav-section">
              <div class="spectrum-Menu-sectionHeading">Backend</div>
              <ul class="spectrum-Menu"><li class="  spectrum-Menu-item" role="menuitem"><a href="../../architecture/bk-architecture.html" class="spectrum-Menu-itemLabel ">Architecture</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../bk-extension-dev-guide.html" class="spectrum-Menu-itemLabel ">PHP Developer Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../ext-best-practices/bk-ext-best-practices.html" class="spectrum-Menu-itemLabel ">Extension Developer Best Practices</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../mrg/intro.html" class="spectrum-Menu-itemLabel ">Module Reference Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../coding-standards/bk-coding-standards.html" class="spectrum-Menu-itemLabel ">Coding Standards</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../contributor-guide/contributing.html" class="spectrum-Menu-itemLabel ">Contributor Guide</a></li></ul>
            </div><div class="nav-section">
              <div class="spectrum-Menu-sectionHeading">Frontend</div>
              <ul class="spectrum-Menu"><li class="  spectrum-Menu-item" role="menuitem"><a href="../../frontend-dev-guide/bk-frontend-dev-guide.html" class="spectrum-Menu-itemLabel ">Frontend Developer Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/guides/v2.4/ui_comp_guide/bk-ui_comps.html" class="spectrum-Menu-itemLabel ">UI Components Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../javascript-dev-guide/bk-javascript-dev-guide.html" class="spectrum-Menu-itemLabel ">JavaScript Developer Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../pattern-library/bk-pattern.html" class="spectrum-Menu-itemLabel ">Admin Design Pattern Library</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../design-styleguide/bk-styleguide.html" class="spectrum-Menu-itemLabel ">Admin Style Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://magento.github.io/pwa-studio/" class="spectrum-Menu-itemLabel ">PWA Documentation Site</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/page-builder/docs/index.html" class="spectrum-Menu-itemLabel ">Page Builder Developer Guide</a></li></ul>
            </div><div class="nav-section">
              <div class="spectrum-Menu-sectionHeading">API</div>
              <ul class="spectrum-Menu"><li class="  spectrum-Menu-item" role="menuitem"><a href="../../get-started/bk-get-started-api.html" class="spectrum-Menu-itemLabel ">Get Started with Magento Web APIs</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../rest/bk-rest.html" class="spectrum-Menu-itemLabel ">REST API Reference</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../soap/bk-soap.html" class="spectrum-Menu-itemLabel ">SOAP API Reference</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../graphql/index.html" class="spectrum-Menu-itemLabel ">GraphQL Developer Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/marketplace/eqp/v1/api.html" class="spectrum-Menu-itemLabel ">Marketplace EQP API Reference</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/mbi/docs/getting-started.html" class="spectrum-Menu-itemLabel ">Business Intelligence API</a></li></ul>
            </div></div></li><li class="nav-main-item spectrum-Tabs-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span class="spectrum-Tabs-itemLabel" tabindex="-1">Testing</span><div class="nav-popup spectrum-Popover"><ul><li class="  spectrum-Menu-item" role="menuitem"><a href="../../test/testing.html" class="spectrum-Menu-itemLabel ">Magento Testing Guide</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/mftf/docs/introduction.html" class="spectrum-Menu-itemLabel ">Functional Acceptance Testing (MFTF)</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../test/integration/integration_test_execution.html" class="spectrum-Menu-itemLabel ">Integration Testing</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../test/js/jasmine.html" class="spectrum-Menu-itemLabel ">JavaScript Unit Testing</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../test/unit/unit_test_execution.html" class="spectrum-Menu-itemLabel ">PHP Unit Testing</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../get-started/web-api-functional-testing.html" class="spectrum-Menu-itemLabel ">Web API Functional Testing</a></li></ul></div></li><li class="nav-main-separator"></li><li class="nav-main-item spectrum-Tabs-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span class="spectrum-Tabs-itemLabel" tabindex="-1">Functional Areas</span><div class="nav-popup spectrum-Popover"><ul><li class="  spectrum-Menu-item" role="menuitem"><a href="../../advanced-reporting/overview.html" class="spectrum-Menu-itemLabel ">Advanced Reporting</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../b2b/bk-b2b.html" class="spectrum-Menu-itemLabel ">B2B</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../howdoi/checkout/checkout_overview.html" class="spectrum-Menu-itemLabel ">Checkout</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/marketplace/sellers/getting-started.html" class="spectrum-Menu-itemLabel ">Extensions Marketplace</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../inventory/index.html" class="spectrum-Menu-itemLabel ">Inventory Management</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="http://omsdocs.magento.com/en/" class="spectrum-Menu-itemLabel ">Order Management</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/page-builder/docs/index.html" class="spectrum-Menu-itemLabel ">Page Builder</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../payments-integrations/bk-payments-integrations.html" class="spectrum-Menu-itemLabel ">Payment Integrations</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/recommendations/product-recs.html" class="spectrum-Menu-itemLabel ">Product Recommendations</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/security/security-and-compliance.html" class="spectrum-Menu-itemLabel ">Security and Compliance</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../staging.html" class="spectrum-Menu-itemLabel ">Staging</a></li></ul></div></li><li class="nav-main-item spectrum-Tabs-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span class="spectrum-Tabs-itemLabel" tabindex="-1">Tutorials</span><div class="nav-popup spectrum-Popover"><ul><li class="  spectrum-Menu-item" role="menuitem"><a href="../../rest/tutorials/index.html" class="spectrum-Menu-itemLabel ">Rest Tutorials</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../howdoi/customize_product.html" class="spectrum-Menu-itemLabel ">Customize Product Creation Form</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="../../howdoi/checkout/checkout_overview.html" class="spectrum-Menu-itemLabel ">Customize Checkout</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/community/resources/support.html" class="spectrum-Menu-itemLabel ">Magento Support</a></li><li class="  spectrum-Menu-item" role="menuitem"><a href="https://devdocs.magento.com/videos/" class="spectrum-Menu-itemLabel ">Video Tutorials</a></li></ul></div></li></ul><!-- /.nav-main -->

    </div>

    <div class="nav-actions">
      <div class="version-switcher spectrum-Dropdown">

	<button id="version-switcher-button" class="spectrum-FieldButton spectrum-Dropdown-trigger dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
		<span class="spectrum-Dropdown-label">Magento 2.4</span>
    <i class="spectrum-Icon spectrum-UIIcon-ChevronDownMedium spectrum-Dropdown-icon" focusable="false" aria-hidden="true"></i>
  </button>

	<div class="dropdown-menu spectrum-Popover spectrum-Popover--bottom spectrum-Dropdown-popover">
		<ul class="dropdown-menu-left spectrum-Menu" aria-labelledby="version-switcher-button">
			
			<li class="spectrum-Menu-item"><a class="dropdown-item spectrum-Menu-itemLabel" href="../../../v2.3/extension-dev-guide/declarative-schema/db-schema.html">Magento 2.3</a></li>
			
			<li class="spectrum-Menu-item"><a class="dropdown-item spectrum-Menu-itemLabel" href="db-schema.html">Magento 2.4</a></li>
			
		</ul>
	</div>
	
</div>

      
<div class="app-switcher">
  <div class="dropdown">
    <button id="app-switcher-trigger" class="app-switcher-trigger" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" aria-label="Documentation sites"></button>
    <div class="dropdown-menu spectrum-Popover spectrum-Dropdown-popover spectrum-Popover--bottom dropdown-menu-right" aria-labelledby="app-switcher-trigger" role="menu">
      <div class="app-switcher-content">
      
      <div class="app-switcher-group">
        <span class="spectrum-Menu-sectionHeading" id="app-switcher-category-1">Developer</span>
        <ul class="spectrum-Menu" role="group" aria-labelledby="app-switcher-category-1">
        
        <li class="spectrum-Menu-item" role="menuitem"><a class="spectrum-Menu-itemLabel" href="../../../../index.html?itm_source=devdocs&amp;itm_medium=top_nav&amp;itm_campaign=app_switcher&amp;itm_term=Commerce&#32;Developer&#32;Documentation">Commerce Developer Documentation</a></li>
        
        <li class="spectrum-Menu-item" role="menuitem"><a class="spectrum-Menu-itemLabel" href="http://pwastudio.io/?itm_source=devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=PWA Studio">PWA Studio</a></li>
        
        <li class="spectrum-Menu-item" role="menuitem"><a class="spectrum-Menu-itemLabel" href="https://omsdocs.magento.com/en/?itm_source=devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Order Management">Order Management</a></li>
        
        </ul>
      </div>
      
      <div class="app-switcher-group">
        <span class="spectrum-Menu-sectionHeading" id="app-switcher-category-2">Merchant</span>
        <ul class="spectrum-Menu" role="group" aria-labelledby="app-switcher-category-2">
        
        <li class="spectrum-Menu-item" role="menuitem"><a class="spectrum-Menu-itemLabel" href="https://docs.magento.com/user-guide/?itm_source=devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Commerce User Guide">Commerce User Guide</a></li>
        
        <li class="spectrum-Menu-item" role="menuitem"><a class="spectrum-Menu-itemLabel" href="https://omsdocs.magento.com/en/userguides/?itm_source=devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Order Management">Order Management</a></li>
        
        <li class="spectrum-Menu-item" role="menuitem"><a class="spectrum-Menu-itemLabel" href="https://docs.magento.com/mbi/?itm_source=devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Business Intelligence">Business Intelligence</a></li>
        
        </ul>
      </div>
      
      </div>
    </div>
  </div>
</div>


      <div class="search-btn">
  <button class="search-trigger" aria-label="Search">
    <svg class="spectrum-Icon" focusable="false" aria-hidden="true" aria-label="Search">
      <rect opacity="0" width="18" height="18" /><path class="a" d="M16.5865,15.107,12.7,11.2215A6.413,6.413,0,1,0,11.2215,12.7l3.886,3.886a1.05,1.05,0,0,0,1.479-1.479ZM3,7.5A4.5,4.5,0,1,1,7.5,12,4.5,4.5,0,0,1,3,7.5Z" />
    </svg>
  </button>
</div>

<div class="quick-search">
  <form
  class="spectrum-Search search-form"
  action="https://devdocs.magento.com/search.html"
>
  <input
    type="search"
    placeholder="Looking for something specific?"
    name="query"
    value=""
    class="spectrum-Textfield-input spectrum-Search-input search-field form-control"
    autocomplete="off"
  />
  <svg
    class="spectrum-Icon spectrum-UIIcon-Magnifier spectrum-Search-icon"
    focusable="false"
    aria-hidden="true"
  >
    <rect fill="#ff13dc" opacity="0" width="18" height="18" /><path class="a" d="M16.5865,15.107,12.7,11.2215A6.413,6.413,0,1,0,11.2215,12.7l3.886,3.886a1.05,1.05,0,0,0,1.479-1.479ZM3,7.5A4.5,4.5,0,1,1,7.5,12,4.5,4.5,0,0,1,3,7.5Z" />
  </svg>
  <button type="reset" class="search-clear spectrum-ClearButton spectrum-SearchClearButton">
    <svg
      class="spectrum-Icon spectrum-UIIcon-CrossSmall"
      focusable="false"
      aria-hidden="true"
    >
      <rect fill="#ff13dc" opacity="0" width="18" height="18" /><path class="a" d="M13.2425,3.343,9,7.586,4.7575,3.343a.5.5,0,0,0-.707,0L3.343,4.05a.5.5,0,0,0,0,.707L7.586,9,3.343,13.2425a.5.5,0,0,0,0,.707l.707.7075a.5.5,0,0,0,.707,0L9,10.414l4.2425,4.243a.5.5,0,0,0,.707,0l.7075-.707a.5.5,0,0,0,0-.707L10.414,9l4.243-4.2425a.5.5,0,0,0,0-.707L13.95,3.343a.5.5,0,0,0-.70711-.00039Z" />
    </svg>
  </button>
</form>

</div>

    </div>

  </div>

</nav><!-- #site-nav -->
<div class="nav-main-fader"></div>


	</header>

	<div class="global-wrapper">

		

		<div class="main-container">
			<a id="main-content"></a>


<div class="content-container">

	<!-- sidebar -->
<aside class="sidebar">
	<button class="toc-toggler">Table of Contents</button>
	<div class="sidebar-wrapper">

		

		<h4 class="guide-title">PHP Developer Guide</h4>
		
		<div class="collapsible-navigation">
		  <ul class="spectrum-SideNav spectrum-SideNav--multiLevel"><li class="  spectrum-SideNav-item" role="menuitem"><a href="../bk-extension-dev-guide.html" class="spectrum-SideNav-itemLink ">Introduction</a><ul class="spectrum-SideNav"><li class="  spectrum-SideNav-item" role="menuitem"><a href="../intro/developers_roadmap.html" class="spectrum-SideNav-itemLink ">Developer roadmap</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../intro/intro-composer.html" class="spectrum-SideNav-itemLink ">Introduction to Composer</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../intro/intro-composer-gloss.html" class="spectrum-SideNav-itemLink ">Glossary of common terms</a></li></ul></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../prepare/prepare.html" class="spectrum-SideNav-itemLink ">Prepare (development quick start)</a><ul class="spectrum-SideNav"><li class="  spectrum-SideNav-item" role="menuitem"><a href="../prepare/dev-modtypes.html" class="spectrum-SideNav-itemLink ">Component types</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../prepare/prepare_file-str.html" class="spectrum-SideNav-itemLink ">About component file structure</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../prepare/ext-repo-structure.html" class="spectrum-SideNav-itemLink ">Extension repository structure</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../prepare/dev-summary.html" class="spectrum-SideNav-itemLink ">Roadmap for developing and packaging components</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../prepare/lifecycle.html" class="spectrum-SideNav-itemLink ">Extension lifecycle</a></li></ul></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../build/build.html" class="spectrum-SideNav-itemLink ">Build</a><ul class="spectrum-SideNav"><li class="  spectrum-SideNav-item" role="menuitem"><a href="../build/di-xml-file.html" class="spectrum-SideNav-itemLink ">The di.xml file</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../build/optimal-dev-environment.html" class="spectrum-SideNav-itemLink ">Optimal development environment</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../build/composer-integration.html" class="spectrum-SideNav-itemLink ">The composer.json file</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../build/required-configuration-files.html" class="spectrum-SideNav-itemLink ">Define your configuration files</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../build/module-file-structure.html" class="spectrum-SideNav-itemLink ">Create your component file structure</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../build/component-registration.html" class="spectrum-SideNav-itemLink ">Register your component</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../build/XSD-XML-validation.html" class="spectrum-SideNav-itemLink ">URN schema validation</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../build/create_component.html" class="spectrum-SideNav-itemLink ">Name your component</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../build/module-load-order.html" class="spectrum-SideNav-itemLink ">Component load order</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../build/enable-module.html" class="spectrum-SideNav-itemLink ">Enable or disable your component</a></li></ul></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../package/package.html" class="spectrum-SideNav-itemLink ">Package</a><ul class="spectrum-SideNav"><li class="  spectrum-SideNav-item" role="menuitem"><a href="../package/package_module.html" class="spectrum-SideNav-itemLink ">Package a component</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../package/package_mktpl.html" class="spectrum-SideNav-itemLink ">Upload your component to the Magento Marketplace</a></li></ul></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../validate/validate.html" class="spectrum-SideNav-itemLink ">Validate</a><ul class="spectrum-SideNav"><li class="  spectrum-SideNav-item" role="menuitem"><a href="../validate/test-module.html" class="spectrum-SideNav-itemLink ">Test your component</a></li></ul></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../cache/partial-caching.html" class="spectrum-SideNav-itemLink ">Partial caching</a><ul class="spectrum-SideNav"><li class="  spectrum-SideNav-item" role="menuitem"><a href="../cache/partial-caching/database-caching.html" class="spectrum-SideNav-itemLink ">Create custom cache engines</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../cache/partial-caching/create-cache-type.html" class="spectrum-SideNav-itemLink ">Create a cache type</a></li></ul></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../cache/page-caching.html" class="spectrum-SideNav-itemLink ">Full page caching</a><ul class="spectrum-SideNav"><li class="  spectrum-SideNav-item" role="menuitem"><a href="../cache/page-caching/public-content.html" class="spectrum-SideNav-itemLink ">Public content</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../cache/page-caching/private-content.html" class="spectrum-SideNav-itemLink ">Private content</a></li></ul></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../cli-cmds/cli-add.html" class="spectrum-SideNav-itemLink ">Add CLI commands</a><ul class="spectrum-SideNav"><li class="  spectrum-SideNav-item" role="menuitem"><a href="../cli-cmds/cli-naming-guidelines.html" class="spectrum-SideNav-itemLink ">Command naming guidelines</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../cli-cmds/cli-howto.html" class="spectrum-SideNav-itemLink ">How to add CLI commands</a></li></ul></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../staging.html" class="spectrum-SideNav-itemLink ">Staging (Magento Commerce only)</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../module-development.html" class="spectrum-SideNav-itemLink ">Component development</a><ul class="spectrum-SideNav"><li class="  spectrum-SideNav-item" role="menuitem"><a href="../async-operations.html" class="spectrum-SideNav-itemLink ">Asynchronous/deferred operations</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../service-contracts/service-contracts.html" class="spectrum-SideNav-itemLink ">Service contracts</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../api-concepts.html" class="spectrum-SideNav-itemLink ">Public interfaces &amp; APIs</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../service-contracts/design-patterns.html" class="spectrum-SideNav-itemLink ">Service contract design patterns</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../depend-inj.html" class="spectrum-SideNav-itemLink ">Dependency injection</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../object-manager.html" class="spectrum-SideNav-itemLink ">ObjectManager</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../events-and-observers.html" class="spectrum-SideNav-itemLink ">Events and observers</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../factories.html" class="spectrum-SideNav-itemLink ">Factories</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../proxies.html" class="spectrum-SideNav-itemLink ">Proxies</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../code-generation.html" class="spectrum-SideNav-itemLink ">Code generation</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../attributes.html" class="spectrum-SideNav-itemLink ">EAV and extension attributes</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../plugins.html" class="spectrum-SideNav-itemLink ">Plugins (Interceptors)</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../routing.html" class="spectrum-SideNav-itemLink ">Routing</a></li><li class="  spectrum-SideNav-item" role="menuitem"><span class="spectrum-SideNav-itemLink ">Indexing</span><ul class=""><li class="  spectrum-SideNav-item" role="menuitem"><a href="../indexing.html" class="spectrum-SideNav-itemLink ">Indexing overview</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../indexer-batch.html" class="spectrum-SideNav-itemLink ">Indexer optimization</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../indexing-custom.html" class="spectrum-SideNav-itemLink ">Adding a custom indexer</a></li></ul></li><li class="  spectrum-SideNav-item" role="menuitem"><span class="spectrum-SideNav-itemLink ">Declarative schema</span><ul class=""><li class="  spectrum-SideNav-item" role="menuitem"><a href="index.html" class="spectrum-SideNav-itemLink ">Declarative schema overview</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="migration-commands.html" class="spectrum-SideNav-itemLink ">Migrate install/upgrade scripts to declarative schema</a></li><li class="is-selected  spectrum-SideNav-item" role="menuitem"><a href="db-schema.html" class="spectrum-SideNav-itemLink ">Configure declarative schema</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="data-patches.html" class="spectrum-SideNav-itemLink ">Develop data and schema patches</a></li></ul></li><li class="  spectrum-SideNav-item" role="menuitem"><span class="spectrum-SideNav-itemLink ">Web APIs</span><ul class=""><li class="  spectrum-SideNav-item" role="menuitem"><a href="../service-contracts/service-to-web-service.html" class="spectrum-SideNav-itemLink ">Configure services as web APIs</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../webapi/custom-routes.html" class="spectrum-SideNav-itemLink ">Set custom routes</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../webapi/request-processor-pool.html" class="spectrum-SideNav-itemLink ">WebApi request processors pool</a></li></ul></li><li class="  spectrum-SideNav-item" role="menuitem"><span class="spectrum-SideNav-itemLink ">Message Queues</span><ul class=""><li class="  spectrum-SideNav-item" role="menuitem"><a href="../message-queues/message-queues.html" class="spectrum-SideNav-itemLink ">Message queues overview</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../message-queues/message-queues-stores.html" class="spectrum-SideNav-itemLink ">Message queues and stores</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../message-queues/config-mq.html" class="spectrum-SideNav-itemLink ">Configure message Queues</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../message-queues/refresh-config.html" class="spectrum-SideNav-itemLink ">Handling outdated in-memory object states</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../message-queues/queue-migration.html" class="spectrum-SideNav-itemLink ">Migrate message queue configuration</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../message-queues/bulk-operations.html" class="spectrum-SideNav-itemLink ">Bulk operations</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../message-queues/implement-bulk.html" class="spectrum-SideNav-itemLink ">Example bulk operations implementation</a></li></ul></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../extension_attributes/adding-attributes.html" class="spectrum-SideNav-itemLink ">Adding extension attributes to entity</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../admin-grid.html" class="spectrum-SideNav-itemLink ">Adding an admin grid</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../searching-with-repositories.html" class="spectrum-SideNav-itemLink ">Searching with repositories</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../../howdoi/php/php_clear-dirs.html" class="spectrum-SideNav-itemLink ">Clear directories during development</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../adapters.html" class="spectrum-SideNav-itemLink ">Adapters</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../view-models.html" class="spectrum-SideNav-itemLink ">View models</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../variable-pool/index.html" class="spectrum-SideNav-itemLink ">Variable Pool</a></li></ul></li><li class="  spectrum-SideNav-item" role="menuitem"><span class="spectrum-SideNav-itemLink ">Configuration</span><ul class="spectrum-SideNav"><li class="  spectrum-SideNav-item" role="menuitem"><a href="../configuration/sensitive-and-environment-settings.html" class="spectrum-SideNav-itemLink ">Sensitive Environment Settings</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../configuration/importers.html" class="spectrum-SideNav-itemLink ">Configuration Importers</a></li></ul></li><li class="  spectrum-SideNav-item" role="menuitem"><span class="spectrum-SideNav-itemLink ">Framework</span><ul class="spectrum-SideNav"><li class="  spectrum-SideNav-item" role="menuitem"><a href="../framework/serializer.html" class="spectrum-SideNav-itemLink ">Serialize Library</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../framework/array-manager.html" class="spectrum-SideNav-itemLink ">Array Manager</a></li></ul></li><li class="  spectrum-SideNav-item" role="menuitem"><span class="spectrum-SideNav-itemLink ">Security</span><ul class="spectrum-SideNav"><li class="  spectrum-SideNav-item" role="menuitem"><a href="../xss-protection.html" class="spectrum-SideNav-itemLink ">XSS Prevention</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../security/non-secure-functions.html" class="spectrum-SideNav-itemLink ">Non-secure functions</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../security/content-security-policies.html" class="spectrum-SideNav-itemLink ">Content Security Policies</a></li></ul></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../versioning/index.html" class="spectrum-SideNav-itemLink ">Versioning</a><ul class="spectrum-SideNav"><li class="  spectrum-SideNav-item" role="menuitem"><a href="../versioning/check-version.html" class="spectrum-SideNav-itemLink ">Check the Magento version</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../versioning/dependencies.html" class="spectrum-SideNav-itemLink ">Module version dependencies</a></li><li class="  spectrum-SideNav-item" role="menuitem"><a href="../versioning/codebase-changes.html" class="spectrum-SideNav-itemLink ">Codebase changes</a></li></ul></li></ul>
		</div>

	</div>

</aside>
<!-- /sidebar -->


	<section class="content">
		<div class="content-wrap">
			<header class="content-header">
				<!-- page-header -->
<section class="page-intro">

  

  

  
  <div class="message-banner">
    This is a beta release of documentation for Magento 2.4, published for previewing soon-to-be-released functionality. Content in this version is subject to change. Links to the v2.4 code base may not properly resolve until the code is officially released.
  </div>
  

  

  

  <h1 class="page-title">Configure declarative schema</h1>

  

  <div class="github-links spectrum-ButtonGroup"><div class="github-link">
    <a class="improve-page spectrum-ActionButton spectrum-ActionButton--quiet" href="https://github.com/magento/devdocs/blob/master/src/guides/v2.4/extension-dev-guide/declarative-schema/db-schema.md" target="_blank">
      <img class="spectrum-Icon spectrum-Icon--sizeS" src="https://devdocs.magento.com/assets/i/icons/edit.svg" alt="" />
      <span class="spectrum-ActionButton-label">Edit on GitHub</span> 
    </a>
  </div><div class="new-issue">
    <a class="spectrum-ActionButton spectrum-ActionButton--quiet" href="https://github.com/magento/devdocs/issues/new?title=Feedback on page: /guides/v2.4/extension-dev-guide/declarative-schema/db-schema.html" target="_blank">
      <img class="spectrum-Icon spectrum-Icon--sizeS"  src="https://devdocs.magento.com/assets/i/icons/bug.svg" alt="" />
      <span class="spectrum-ActionButton-label">Log an Issue</span>
    </a>
  </div></div>


  



 

  

</section>

			</header>
			<main>
				<p>Before Magento 2.3, extension developers were required to write code (PHP scripts) to change the database schema. The following types of scripts existed before Magento 2.3:</p>

<ul>
  <li>InstallData and InstallSchema scripts, which are executed the first time a module is installed.</li>
  <li>UpgradeData and UpgradeSchema incremental scripts, which supplement an existing module schema.</li>
  <li>Recurring scripts, which are executed each time you install or upgrade Magento.</li>
</ul>

<p>Each script iteratively adds changes. During the installation process, upgrade scripts apply only those changes that have not been applied yet. For example, if you have a module with version 2.1.8 installed and the latest version is 2.1.11, then the upgrade script changes for 2.1.9, 2.1.10, and 2.1.11 will be applied, in order, when you upgrade to 2.1.11. Each upgrade script is responsible for checking the required version for each change to apply. The Magento installation only knows that a module has an upgrade script, not what versions it affected. That procedure is called <em>migration setup</em> or <em>migration scripts</em>.</p>

<p>The main disadvantage of this approach is that Magento applies changes blindly. For example, in one version a new database column might be introduced, only to be removed in the next. <em>Declarative setup</em> eliminates this type of unnecessary work.</p>

<p>Declarative setup is based on database structure declarations, and is used in projects such as <a href="http://www.doctrine-project.org/">Doctrine</a>. Schema files declare what the database structure should be,
and Magento determines the differences between the current table structure and what it should be. These differences can be represented with atomic SQL operations.</p>

<p>Magento prioritizes the declarative schema and executes the declarative install schemas before the <a href="data-patches.html">data and schema patches</a>.</p>

<p>The following example, extracted from the <code class="language-plaintext highlighter-rouge">Catalog/etc/db_schema.xml</code> file, defines the <code class="language-plaintext highlighter-rouge">catalog_product_entity_datetime</code> table:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;table</span> <span class="na">name=</span><span class="s">"catalog_product_entity_datetime"</span> <span class="na">resource=</span><span class="s">"default"</span> <span class="na">engine=</span><span class="s">"innodb"</span>
           <span class="na">comment=</span><span class="s">"Catalog Product Datetime Attribute Backend Table"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;column</span> <span class="na">xsi:type=</span><span class="s">"int"</span> <span class="na">name=</span><span class="s">"value_id"</span> <span class="na">padding=</span><span class="s">"11"</span> <span class="na">unsigned=</span><span class="s">"false"</span> <span class="na">nullable=</span><span class="s">"false"</span> <span class="na">identity=</span><span class="s">"true"</span> <span class="na">comment=</span><span class="s">"Value ID"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;column</span> <span class="na">xsi:type=</span><span class="s">"smallint"</span> <span class="na">name=</span><span class="s">"attribute_id"</span> <span class="na">padding=</span><span class="s">"5"</span> <span class="na">unsigned=</span><span class="s">"true"</span> <span class="na">nullable=</span><span class="s">"false"</span> <span class="na">identity=</span><span class="s">"false"</span> <span class="na">default=</span><span class="s">"0"</span> <span class="na">comment=</span><span class="s">"Attribute ID"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;column</span> <span class="na">xsi:type=</span><span class="s">"smallint"</span> <span class="na">name=</span><span class="s">"store_id"</span> <span class="na">padding=</span><span class="s">"5"</span> <span class="na">unsigned=</span><span class="s">"true"</span> <span class="na">nullable=</span><span class="s">"false"</span> <span class="na">identity=</span><span class="s">"false"</span> <span class="na">default=</span><span class="s">"0"</span> <span class="na">comment=</span><span class="s">"Store ID"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;column</span> <span class="na">xsi:type=</span><span class="s">"int"</span> <span class="na">name=</span><span class="s">"entity_id"</span> <span class="na">padding=</span><span class="s">"10"</span> <span class="na">unsigned=</span><span class="s">"true"</span> <span class="na">nullable=</span><span class="s">"false"</span> <span class="na">identity=</span><span class="s">"false"</span> <span class="na">default=</span><span class="s">"0"</span> <span class="na">comment=</span><span class="s">"Entity ID"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;column</span> <span class="na">xsi:type=</span><span class="s">"datetime"</span> <span class="na">name=</span><span class="s">"value"</span> <span class="na">on_update=</span><span class="s">"false"</span> <span class="na">nullable=</span><span class="s">"true"</span> <span class="na">comment=</span><span class="s">"Value"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;constraint</span> <span class="na">xsi:type=</span><span class="s">"primary"</span> <span class="na">referenceId=</span><span class="s">"PRIMARY"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;column</span> <span class="na">name=</span><span class="s">"value_id"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/constraint&gt;</span>
    <span class="nt">&lt;constraint</span> <span class="na">xsi:type=</span><span class="s">"foreign"</span> <span class="na">referenceId=</span><span class="s">"CAT_PRD_ENTT_DTIME_ATTR_ID_EAV_ATTR_ATTR_ID"</span> <span class="na">table=</span><span class="s">"catalog_product_entity_datetime"</span> <span class="na">column=</span><span class="s">"attribute_id"</span> <span class="na">referenceTable=</span><span class="s">"eav_attribute"</span> <span class="na">referenceColumn=</span><span class="s">"attribute_id"</span> <span class="na">onDelete=</span><span class="s">"CASCADE"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;constraint</span> <span class="na">xsi:type=</span><span class="s">"foreign"</span> <span class="na">referenceId=</span><span class="s">"CAT_PRD_ENTT_DTIME_ENTT_ID_CAT_PRD_ENTT_ENTT_ID"</span> <span class="na">table=</span><span class="s">"catalog_product_entity_datetime"</span> <span class="na">column=</span><span class="s">"entity_id"</span> <span class="na">referenceTable=</span><span class="s">"catalog_product_entity"</span> <span class="na">referenceColumn=</span><span class="s">"entity_id"</span> <span class="na">onDelete=</span><span class="s">"CASCADE"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;constraint</span> <span class="na">xsi:type=</span><span class="s">"foreign"</span> <span class="na">referenceId=</span><span class="s">"CATALOG_PRODUCT_ENTITY_DATETIME_STORE_ID_STORE_STORE_ID"</span> <span class="na">table=</span><span class="s">"catalog_product_entity_datetime"</span> <span class="na">column=</span><span class="s">"store_id"</span> <span class="na">referenceTable=</span><span class="s">"store"</span> <span class="na">referenceColumn=</span><span class="s">"store_id"</span> <span class="na">onDelete=</span><span class="s">"CASCADE"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;constraint</span> <span class="na">xsi:type=</span><span class="s">"unique"</span> <span class="na">referenceId=</span><span class="s">"CATALOG_PRODUCT_ENTITY_DATETIME_ENTITY_ID_ATTRIBUTE_ID_STORE_ID"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;column</span> <span class="na">name=</span><span class="s">"entity_id"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;column</span> <span class="na">name=</span><span class="s">"attribute_id"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;column</span> <span class="na">name=</span><span class="s">"store_id"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/constraint&gt;</span>
    <span class="nt">&lt;index</span> <span class="na">referenceId=</span><span class="s">"CATALOG_PRODUCT_ENTITY_DATETIME_ATTRIBUTE_ID"</span> <span class="na">indexType=</span><span class="s">"btree"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;column</span> <span class="na">name=</span><span class="s">"attribute_id"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/index&gt;</span>
    <span class="nt">&lt;index</span> <span class="na">referenceId=</span><span class="s">"CATALOG_PRODUCT_ENTITY_DATETIME_STORE_ID"</span> <span class="na">indexType=</span><span class="s">"btree"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;column</span> <span class="na">name=</span><span class="s">"store_id"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/index&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="db_schema-structure"><code class="language-plaintext highlighter-rouge">db_schema</code> structure</h2>

<p>The <code class="language-plaintext highlighter-rouge">&lt;Module_Vendor&gt;/&lt;Module_Name&gt;/etc/db_schema.xml</code> file declares a module’s database structure.</p>

<p class="bs-callout-info">If you have enabled <a href="../../config-guide/cli/config-cli-subcommands-urn.html">URN highlighting</a>, you can use the PhpStorm autocomplete feature after choosing a node’s <code class="language-plaintext highlighter-rouge">xsi:type</code>. This will also allow you to view which attributes are available on each line of your <code class="language-plaintext highlighter-rouge">db_schema.xml</code> file</p>

<h3 id="top-level-node">Top-level node</h3>

<p>The <code class="language-plaintext highlighter-rouge">schema</code> node defines the location of the <code class="language-plaintext highlighter-rouge">schema.xsd</code>  file.</p>

<p><code class="language-plaintext highlighter-rouge">&lt;schema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:noNamespaceSchemaLocation="urn:magento:framework:Setup/Declaration/Schema/etc/schema.xsd"&gt;</code></p>

<h3 id="table-node"><code class="language-plaintext highlighter-rouge">table</code> node</h3>

<p>Each <code class="language-plaintext highlighter-rouge">db_schema.xml</code> file should contain one or more <code class="language-plaintext highlighter-rouge">table</code> nodes. Each table node represents a table in the database.
A table node can contain the following attributes:</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">name</code></td>
      <td>The name of the table</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">engine</code></td>
      <td>SQL engine. This value must be <code class="language-plaintext highlighter-rouge">innodb</code> or <code class="language-plaintext highlighter-rouge">memory</code>.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">resource</code></td>
      <td>The database shard on which to install the table. This value must be <code class="language-plaintext highlighter-rouge">default</code>, <code class="language-plaintext highlighter-rouge">checkout</code>, or <code class="language-plaintext highlighter-rouge">sales</code>.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">comment</code></td>
      <td>Table comment</td>
    </tr>
  </tbody>
</table>

<p>A <code class="language-plaintext highlighter-rouge">table</code> node can contain three types of subnodes:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">column</code></li>
  <li><code class="language-plaintext highlighter-rouge">constraint</code></li>
  <li><code class="language-plaintext highlighter-rouge">index</code></li>
</ul>

<h4 id="column-subnode"><code class="language-plaintext highlighter-rouge">column</code> subnode</h4>

<p>The <code class="language-plaintext highlighter-rouge">column</code> subnode defines a column in a table. Each column requires its own declaration.</p>

<p>A column can have the following attributes:</p>

<table>
<tr><th>Attribute</th><th>Description</th></tr>
<tr>
<td><code>xsi:type</code></td>
<td><p>Specifies the column type. Must be one of the following:</p>
<ul>
<li><code>blob</code>  (includes blob, mediumblob, longblob)</li>
<li><code>boolean</code></li>
<li><code>date</code></li>
<li><code>datetime</code></li>
<li><code>decimal</code></li>
<li><code>float</code></li>
<li><code>int</code> (includes smallint, bigint, tinyint)</li>
<li><code>real</code> (includes decimal, float, double, real)</li>
<li><code>smallint</code></li>
<li><code>text</code> (includes text, mediumtext, longtext)</li>
<li><code>timestamp</code></li>
<li><code>varbinary</code></li>
<li><code>varchar</code></li>
</ul></td>
</tr>
<tr>
<td><code>default</code></td>
<td>Initializes the column with the specified default value. The default value should have the same datatype defined in <code>xsi:type</code>.
</td>
</tr>
<tr>
<td><code>disabled</code></td>
<td>Disables or deletes the declared table, column, constraint, or index.
</td>
</tr>
<tr>
<td><code>identity</code></td>
<td>Indicates whether a column is auto incremented.
</td>
</tr>
<tr>
<td><code>length</code></td>
<td>Specifies the length of a column. Can be used for `char`, `varchar`, and `varbinary` types.</td>
</tr>
<tr>
<td><code>nullable</code></td>
<td>Indicates whether column can be nullable.</td>
</tr>
<tr>
<td><code>onCreate</code></td>
<td>This is a DDL trigger that allows you to move data from an existing column to a newly created column. This trigger works only when a column is created.</td>
</tr>
<tr>
<td><code>padding</code></td>
<td>The size of an integer column.</td>
</tr>
<tr>
<td><code>precision</code></td>
<td>The number of allowed digits in a real data type.</td>
</tr>
<tr>
<td><code>scale</code></td>
<td>The number of digits after the decimal in a real data type.</td>
</tr>
<tr>
<td><code>unsigned</code></td>
<td>For numeric data types, specifies whether the column can contain positive and negative values or only positive values.</td>
</tr>
</table>

<p>For more information about each type, refer to the annotations in the corresponding XSD file. The location of the XSD file depends on how you installed Magento.</p>

<ul>
  <li><a href="../../install-gde/prereq/zip_install.html">Archive download</a>: <code class="language-plaintext highlighter-rouge">&lt;Magento_root_directory/vendor/magento/framework/Setup/Declaration/Schema/etc</code></li>
  <li><a href="../../install-gde/composer.html">Composer</a> or <a href="../../install-gde/prereq/dev_install.html">GitHub</a> installation: <code class="language-plaintext highlighter-rouge">&lt;Magento_root_directory/lib/internal/Magento/Framework/Setup/Declaration/Schema/etc</code></li>
</ul>

<p>Example:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;column</span> <span class="na">xsi:type=</span><span class="s">"int"</span> <span class="na">name=</span><span class="s">"entity_id"</span> <span class="na">padding=</span><span class="s">"10"</span> <span class="na">unsigned=</span><span class="s">"true"</span> <span class="na">nullable=</span><span class="s">"false"</span> <span class="na">identity=</span><span class="s">"true"</span> <span class="na">comment=</span><span class="s">"Credit ID"</span><span class="nt">/&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="constraint-subnode"><code class="language-plaintext highlighter-rouge">constraint</code> subnode</h4>

<p>The <code class="language-plaintext highlighter-rouge">constraint</code> subnode always contains the following attributes:</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">type</code></td>
      <td>One of <code class="language-plaintext highlighter-rouge">primary</code>, <code class="language-plaintext highlighter-rouge">unique</code>, or <code class="language-plaintext highlighter-rouge">foreign</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">referenceId</code></td>
      <td>A custom identifier that is used only for relation mapping in the scope of <code class="language-plaintext highlighter-rouge">db_schema.xml</code> files. The real entity in the database has a system-generated name. The most convenient way to set the value of this attribute is to use the value that is written in the module’s <code class="language-plaintext highlighter-rouge">db_schema_whitelist.json</code>  file when you <a href="migration-commands.html#create-whitelist">run the <code class="language-plaintext highlighter-rouge">generate-whitelist</code> command</a>.</td>
    </tr>
  </tbody>
</table>

<p>The <code class="language-plaintext highlighter-rouge">primary</code> and <code class="language-plaintext highlighter-rouge">unique</code> constraints are called “internal” constraints, because they can be applied only to the scope of the table where they are created. Internal constraints define one or more <code class="language-plaintext highlighter-rouge">column</code> subnodes. Each subnode defines a constrained column.</p>

<p>The following example shows the format of an internal constraint.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;constraint</span> <span class="na">xsi:type=</span><span class="s">"primary"</span> <span class="na">referenceId=</span><span class="s">"PRIMARY"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;column</span> <span class="na">name=</span><span class="s">"entity_id"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/constraint&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">foreign</code> constraint is similar to foreign keys in SQL. This type of constraint connects two tables with each other. The following attributes define a foreign constraint:</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">table</code></td>
      <td>The name of the current table</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">column</code></td>
      <td>A column in the current table that refers to a specific column in another table</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">referenceTable</code></td>
      <td>The table being referenced</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">referenceColumn</code></td>
      <td>A column in the <code class="language-plaintext highlighter-rouge">referenceTable</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">onDelete</code></td>
      <td>Foreign key trigger. The value must be <code class="language-plaintext highlighter-rouge">CASCADE</code>, <code class="language-plaintext highlighter-rouge">SET NULL</code>, or <code class="language-plaintext highlighter-rouge">NO ACTION</code></td>
    </tr>
  </tbody>
</table>

<p class="bs-callout-info">To keep entity identifiers as immutable values, the declarative schema does not support <code class="language-plaintext highlighter-rouge">ON UPDATE</code> action for <code class="language-plaintext highlighter-rouge">constraint</code>.</p>

<p>Example:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;constraint</span> <span class="na">xsi:type=</span><span class="s">"foreign"</span> <span class="na">referenceId=</span><span class="s">"COMPANY_CREDIT_COMPANY_ID_DIRECTORY_COUNTRY_COUNTRY_ID"</span> <span class="na">table=</span><span class="s">"company_credit"</span> <span class="na">column=</span><span class="s">"company_id"</span> <span class="na">referenceTable=</span><span class="s">"company"</span> <span class="na">referenceColumn=</span><span class="s">"entity_id"</span> <span class="na">onDelete=</span><span class="s">"CASCADE"</span><span class="nt">/&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="index-subnode"><code class="language-plaintext highlighter-rouge">index</code> subnode</h4>

<p>The <code class="language-plaintext highlighter-rouge">index</code> subnode has the same structure as internal constraints but contains different logic. While constraints are used for defining limitations, indexes are used for speeding up DQL operations. The following attributes define an index:</p>

<table>
  <thead>
    <tr>
      <th>Attribute</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">referenceId</code></td>
      <td>A custom identifier that is used only for relation mapping in the scope of <code class="language-plaintext highlighter-rouge">db_schema.xml</code> files. The real entity in the database has a system-generated name. The most convenient way to set the value of this attribute is to use the value that is written in the module’s <code class="language-plaintext highlighter-rouge">db_schema_whitelist.json</code>  file when you <a href="migration-commands.html#create-whitelist">run the <code class="language-plaintext highlighter-rouge">generate-whitelist</code> command</a>.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">indexType</code></td>
      <td>The value must be <code class="language-plaintext highlighter-rouge">btree</code>, <code class="language-plaintext highlighter-rouge">fulltext</code>, or <code class="language-plaintext highlighter-rouge">hash</code></td>
    </tr>
  </tbody>
</table>

<p>Example:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;index</span> <span class="na">referenceId=</span><span class="s">"NEWSLETTER_SUBSCRIBER_CUSTOMER_ID"</span> <span class="na">indexType=</span><span class="s">"btree"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;column</span> <span class="na">name=</span><span class="s">"customer_id"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/index&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="perform-common-database-operations">Perform common database operations</h2>

<p>This section shows how to perform common database operations using declarative schema. The screen captures use <code class="language-plaintext highlighter-rouge">git diff</code> to illustrate how to perform these tasks.</p>

<h3 id="create-a-table">Create a table</h3>

<p>The following example creates the <code class="language-plaintext highlighter-rouge">declarative_table</code> table with four columns. The <code class="language-plaintext highlighter-rouge">id_column</code> column is the primary key.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="gd">&lt;schema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
</span>                 xsi:noNamespaceSchemaLocation="urn:magento:framework:Setup/Declaration/Schema/etc/schema.xsd"&gt;
<span class="gi">+    &lt;table name="declarative_table"&gt;
+        &lt;column xsi:type="int" name="id_column" padding="10" unsigned="true" nullable="false" comment="Entity Id"/&gt;
+        &lt;column xsi:type="int" name="severity" padding="10" unsigned="true" nullable="false" comment="Severity code"/&gt;
+        &lt;column xsi:type="varchar" name="title" nullable="false" length="255" comment="Title"/&gt;
+        &lt;column xsi:type="timestamp" name="time_occurred" padding="10" comment="Time of event"/&gt;
+        &lt;constraint xsi:type="primary" referenceId="PRIMARY"&gt;
+            &lt;column name="id_column"/&gt;
+        &lt;/constraint&gt;
+    &lt;/table&gt;
</span><span class="gd">&lt;/schema&gt;
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p class="bs-callout-info">When creating a new table, remember to <a href="migration-commands.html#create-whitelist">generate</a> the <code class="language-plaintext highlighter-rouge">db_schema_whitelist.json</code> file.</p>

<h3 id="drop-a-table">Drop a table</h3>

<p>In the following example, the <code class="language-plaintext highlighter-rouge">declarative_table</code> table was completely removed from the <code class="language-plaintext highlighter-rouge">db-schema.xml</code> file.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="gd">&lt;schema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
</span>                 xsi:noNamespaceSchemaLocation="urn:magento:framework:Setup/Declaration/Schema/etc/schema.xsd"&gt;
<span class="gd">-    &lt;table name="declarative_table"&gt;
-        &lt;column xsi:type="int" name="id_column" padding="10" unsigned="true" nullable="false" comment="Entity Id"/&gt;
-        &lt;column xsi:type="int" name="severity" padding="10" unsigned="true" nullable="false" comment="Severity code"/&gt;
-        &lt;column xsi:type="varchar" name="title" nullable="false" length="255" comment="Title"/&gt;
-        &lt;column xsi:type="timestamp" name="time_occurred" padding="10" comment="Time of event"/&gt;
-        &lt;constraint xsi:type="primary" referenceId="PRIMARY"&gt;
-            &lt;column name="id_column"/&gt;
-        &lt;/constraint&gt;
-    &lt;/table&gt;
&lt;/schema&gt;
</span></pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="rename-a-table">Rename a table</h3>

<p>Table renaming is supported. The declarative schema will create a new table with the new name and drop the table with the old name.
Renaming a table via <code class="language-plaintext highlighter-rouge">RENAME TABLE</code> is <em>NOT</em> supported.
To migrate data from another table, specify the <code class="language-plaintext highlighter-rouge">onCreate</code> attribute on the <code class="language-plaintext highlighter-rouge">table</code> declaration, and add specify the source table name:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>onCreate="migrateDataFromAnotherTable(catalog_category_entity)"
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Please note that migrating data from another table and renaming columns at the same time is not supported.</p>

<p>This declarative process of renaming a table is not fast. If you need to migrate lots of data quickly you can create a CSV table dump using the <code class="language-plaintext highlighter-rouge">--safe-mode=1</code> and add the data manually by using data/recurring patches.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="gd">&lt;schema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
</span>                 xsi:noNamespaceSchemaLocation="urn:magento:framework:Setup/Declaration/Schema/etc/schema.xsd"&gt;
<span class="gi">+    &lt;table name="new_declarative_table" onCreate="migrateDataFromAnotherTable(declarative_table)"&gt;
</span><span class="gd">-    &lt;table name="declarative_table"&gt;
</span>        &lt;column xsi:type="int" name="id_column" padding="10" unsigned="true" nullable="false" comment="Entity Id"/&gt;
        &lt;column xsi:type="int" name="severity" padding="10" unsigned="true" nullable="false" comment="Severity code"/&gt;
        &lt;column xsi:type="varchar" name="title" nullable="false" length="255" comment="Title"/&gt;
        &lt;column xsi:type="timestamp" name="time_occurred" padding="10" comment="Time of event"/&gt;
        &lt;constraint xsi:type="primary" referenceId="PRIMARY"&gt;
            &lt;column name="id_column"/&gt;
        &lt;/constraint&gt;
    &lt;/table&gt;
<span class="gd">&lt;/schema&gt;
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p class="bs-callout-info">When renaming a table, remember to regenerate the <code class="language-plaintext highlighter-rouge">db_schema_whitelist.json</code> file so it contains the new name in addition to the old one.</p>

<h3 id="add-a-column-to-table">Add a column to table</h3>

<p>The following example adds the <code class="language-plaintext highlighter-rouge">date_closed</code> column.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="gd">&lt;schema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
</span>                 xsi:noNamespaceSchemaLocation="urn:magento:framework:Setup/Declaration/Schema/etc/schema.xsd"&gt;
    &lt;table name="declarative_table"&gt;
        &lt;column xsi:type="int" name="id_column" padding="10" unsigned="true" nullable="false" comment="Entity Id"/&gt;
        &lt;column xsi:type="int" name="severity" padding="10" unsigned="true" nullable="false" comment="Severity code"/&gt;
        &lt;column xsi:type="varchar" name="title" nullable="false" length="255" comment="Title"/&gt;
        &lt;column xsi:type="timestamp" name="time_occurred" padding="10" comment="Time of event"/&gt;
<span class="gi">+       &lt;column xsi:type="timestamp" name="date_closed" padding="10" comment="Time of event"/&gt;
</span>        &lt;constraint xsi:type="primary" referenceId="PRIMARY"&gt;
            &lt;column name="id_column"/&gt;
        &lt;/constraint&gt;
    &lt;/table&gt;
<span class="gd">&lt;/schema&gt;
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p class="bs-callout-info">When adding a new column into table, remember to <a href="migration-commands.html#create-whitelist">generate</a> the <code class="language-plaintext highlighter-rouge">db_schema_whitelist.json</code> file.</p>

<h3 id="drop-a-column-from-a-table">Drop a column from a table</h3>

<p>The following example removes the  <code class="language-plaintext highlighter-rouge">date_closed</code> column by deleting its <code class="language-plaintext highlighter-rouge">column</code> node. To drop a column declared in another module, redeclare it with the <code class="language-plaintext highlighter-rouge">disabled</code> attribute set to <code class="language-plaintext highlighter-rouge">true</code>.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="gd">&lt;schema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
</span>                 xsi:noNamespaceSchemaLocation="urn:magento:framework:Setup/Declaration/Schema/etc/schema.xsd"&gt;
    &lt;table name="declarative_table"&gt;
        &lt;column xsi:type="int" name="id_column" padding="10" unsigned="true" nullable="false" comment="Entity Id"/&gt;
        &lt;column xsi:type="int" name="severity" padding="10" unsigned="true" nullable="false" comment="Severity code"/&gt;
        &lt;column xsi:type="varchar" name="title" nullable="false" length="255" comment="Title"/&gt;
        &lt;column xsi:type="timestamp" name="time_occurred" padding="10" comment="Time of event"/&gt;
<span class="gd">-       &lt;column xsi:type="timestamp" name="date_closed" padding="10" comment="Time of event"/&gt;
</span>        &lt;constraint xsi:type="primary" referenceId="PRIMARY"&gt;
            &lt;column name="id_column"/&gt;
        &lt;/constraint&gt;
    &lt;/table&gt;
<span class="gd">&lt;/schema&gt;
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p class="bs-callout-info">It is possible to drop a column only if it exists in the <code class="language-plaintext highlighter-rouge">db_schema_whitelist.json</code> file.</p>

<h3 id="change-the-column-type">Change the column type</h3>

<p>The following example changes the <code class="language-plaintext highlighter-rouge">type</code> of the <code class="language-plaintext highlighter-rouge">title</code> column from <code class="language-plaintext highlighter-rouge">varchar</code> to  <code class="language-plaintext highlighter-rouge">text</code>.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="gd">&lt;schema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
</span>                 xsi:noNamespaceSchemaLocation="urn:magento:framework:Setup/Declaration/Schema/etc/schema.xsd"&gt;
    &lt;table name="declarative_table"&gt;
        &lt;column xsi:type="int" name="id_column" padding="10" unsigned="true" nullable="false" comment="Entity Id"/&gt;
        &lt;column xsi:type="int" name="severity" padding="10" unsigned="true" nullable="false" comment="Severity code"/&gt;
<span class="gd">-       &lt;column xsi:type="varchar" name="title" nullable="false" length="255" comment="Title"/&gt;
</span><span class="gi">+       &lt;column xsi:type="text" name="title" nullable="false" comment="Title"/&gt;
</span>        &lt;column xsi:type="timestamp" name="time_occurred" padding="10" comment="Time of event"/&gt;
        &lt;constraint xsi:type="primary" referenceId="PRIMARY"&gt;
            &lt;column name="id_column"/&gt;
        &lt;/constraint&gt;
    &lt;/table&gt;
<span class="gd">&lt;/schema&gt;
</span></pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="rename-a-column">Rename a column</h3>

<p>To rename a column, delete the original column declaration and create a new one. In the new column declaration, use the <code class="language-plaintext highlighter-rouge">onCreate</code> attribute to specify which column to migrate data from. Use the following construction to migrate data from the same table.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>onCreate="migrateDataFrom(entity_id)"
</pre></td></tr></tbody></table></code></pre></div></div>

<p class="bs-callout-info">When renaming a column, remember to regenerate the <code class="language-plaintext highlighter-rouge">db_schema_whitelist.json</code> file so it contains the new name in addition to the old one.</p>

<h3 id="add-an-index">Add an index</h3>

<p>The following example adds the <code class="language-plaintext highlighter-rouge">INDEX_SEVERITY</code> index to the <code class="language-plaintext highlighter-rouge">declarative_table</code> table.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="gd">&lt;schema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
</span>                 xsi:noNamespaceSchemaLocation="urn:magento:framework:Setup/Declaration/Schema/etc/schema.xsd"&gt;
    &lt;table name="declarative_table"&gt;
        &lt;column xsi:type="int" name="id_column" padding="10" unsigned="true" nullable="false" comment="Entity Id"/&gt;
        &lt;column xsi:type="int" name="severity" padding="10" unsigned="true" nullable="false" comment="Severity code"/&gt;
        &lt;column xsi:type="text" name="title" nullable="false" length="255" comment="Title"/&gt;
        &lt;column xsi:type="timestamp" name="time_occurred" padding="10" comment="Time of event"/&gt;
        &lt;constraint xsi:type="primary" referenceId="PRIMARY"&gt;
            &lt;column name="id_column"/&gt;
        &lt;/constraint&gt;
<span class="gi">+       &lt;index referenceId="INDEX_SEVERITY" indexType="btree"&gt;
+           &lt;column name="severity"/&gt;
+       &lt;/index&gt;
</span>    &lt;/table&gt;
<span class="gd">&lt;/schema&gt;
</span></pre></td></tr></tbody></table></code></pre></div></div>
<h3 id="create-a-foreign-key">Create a foreign key</h3>

<p>In the following example, the selected <code class="language-plaintext highlighter-rouge">constraint</code> node defines the characteristics of the <code class="language-plaintext highlighter-rouge">FL_ALLOWED_SEVERITIES</code> foreign key.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="gd">&lt;schema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
</span>                 xsi:noNamespaceSchemaLocation="urn:magento:framework:Setup/Declaration/Schema/etc/schema.xsd"&gt;
    &lt;table name="declarative_table"&gt;
        &lt;column xsi:type="int" name="id_column" padding="10" unsigned="true" nullable="false" comment="Entity Id"/&gt;
        &lt;column xsi:type="int" name="severity" padding="10" unsigned="true" nullable="false" comment="Severity code"/&gt;
        &lt;column xsi:type="varchar" name="title" nullable="false" length="255" comment="Title"/&gt;
        &lt;column xsi:type="timestamp" name="time_occurred" padding="10" comment="Time of event"/&gt;
        &lt;constraint xsi:type="primary" referenceId="PRIMARY"&gt;
            &lt;column name="id_column"/&gt;
        &lt;/constraint&gt;
<span class="gi">+       &lt;constraint xsi:type="foreign" referenceId="FL_ALLOWED_SEVERITIES" table="declarative_table"
+               column="severity" referenceTable="severities" referenceColumn="severity_identifier"
+               onDelete="CASCADE"/&gt;
</span>    &lt;/table&gt;
<span class="gd">&lt;/schema&gt;
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p class="bs-callout-info">Foreign keys can only be added to tables when both tables were created using a declarative schema (<code class="language-plaintext highlighter-rouge">db_schema.xml</code>).</p>

<h3 id="drop-a-foreign-key">Drop a foreign key</h3>

<p>The following example removes the  <code class="language-plaintext highlighter-rouge">FL_ALLOWED_SEVERITIES</code> foreign key by deleting its <code class="language-plaintext highlighter-rouge">constraint</code> node. To drop a constraint declared in another module, redeclare it with the <code class="language-plaintext highlighter-rouge">disabled</code> attribute set to <code class="language-plaintext highlighter-rouge">true</code>.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="gd">&lt;schema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
</span>                 xsi:noNamespaceSchemaLocation="urn:magento:framework:Setup/Declaration/Schema/etc/schema.xsd"&gt;
    &lt;table name="declarative_table"&gt;
        &lt;column xsi:type="int" name="id_column" padding="10" unsigned="true" nullable="false" comment="Entity Id"/&gt;
        &lt;column xsi:type="int" name="severity" padding="10" unsigned="true" nullable="false" comment="Severity code"/&gt;
        &lt;column xsi:type="varchar" name="title" nullable="false" length="255" comment="Title"/&gt;
        &lt;column xsi:type="timestamp" name="time_occurred" padding="10" comment="Time of event"/&gt;
        &lt;constraint xsi:type="primary" referenceId="PRIMARY"&gt;
            &lt;column name="id_column"/&gt;
        &lt;/constraint&gt;
<span class="gd">-       &lt;constraint xsi:type="foreign" referenceId="FL_ALLOWED_SEVERITIES" table="declarative_table"
-               column="severity" referenceTable="severities" referenceColumn="severity_identifier"
-               onDelete="CASCADE"/&gt;
</span>    &lt;/table&gt;
<span class="gd">&lt;/schema&gt;
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p class="bs-callout-info">It is possible to drop a foreign key only if it exists in the <code class="language-plaintext highlighter-rouge">db_schema_whitelist.json</code> file.</p>

<h3 id="recreate-a-foreign-key">Recreate a foreign key</h3>

<p>In this example, Module A defines a new table with primary key <code class="language-plaintext highlighter-rouge">id_column</code>. Module B declares its own schema, in which it creates a new column (<code class="language-plaintext highlighter-rouge">new_id_column</code>) and changes the primary index to this column.
Module B disables the original primary key and sets a new primary key with a <code class="language-plaintext highlighter-rouge">referenceId</code> value that is different from PRIMARY. Although this value is different, the real name of the primary key in the database remains PRIMARY.</p>

<p><strong>Module A declaration:</strong></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;schema</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
                 <span class="na">xsi:noNamespaceSchemaLocation=</span><span class="s">"urn:magento:framework:Setup/Declaration/Schema/etc/schema.xsd"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;table</span> <span class="na">name=</span><span class="s">"declarative_table"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;column</span> <span class="na">xsi:type=</span><span class="s">"int"</span> <span class="na">name=</span><span class="s">"id_column"</span> <span class="na">padding=</span><span class="s">"10"</span> <span class="na">unsigned=</span><span class="s">"true"</span> <span class="na">nullable=</span><span class="s">"false"</span> <span class="na">comment=</span><span class="s">"Entity Id"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;constraint</span> <span class="na">xsi:type=</span><span class="s">"primary"</span> <span class="na">referenceId=</span><span class="s">"PRIMARY"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;column</span> <span class="na">name=</span><span class="s">"id_column"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/constraint&gt;</span>
    <span class="nt">&lt;/table&gt;</span>
<span class="nt">&lt;/schema&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>Module B declaration:</strong></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlighter"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;schema</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
        <span class="na">xsi:noNamespaceSchemaLocation=</span><span class="s">"urn:magento:framework:Setup/Declaration/Schema/etc/schema.xsd"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;table</span> <span class="na">name=</span><span class="s">"declarative_table"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;column</span> <span class="na">xsi:type=</span><span class="s">"int"</span> <span class="na">name=</span><span class="s">"new_id_column"</span> <span class="na">padding=</span><span class="s">"10"</span> <span class="na">unsigned=</span><span class="s">"true"</span> <span class="na">nullable=</span><span class="s">"false"</span>
                <span class="na">comment=</span><span class="s">"New Entity Id"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;constraint</span> <span class="na">xsi:type=</span><span class="s">"primary"</span> <span class="na">referenceId=</span><span class="s">"PRIMARY"</span> <span class="na">disabled=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;constraint</span> <span class="na">xsi:type=</span><span class="s">"primary"</span> <span class="na">referenceId=</span><span class="s">"NEW_PRIMARY"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;column</span> <span class="na">name=</span><span class="s">"new_id_column"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/constraint&gt;</span>
    <span class="nt">&lt;/table&gt;</span>
<span class="nt">&lt;/schema&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="other-tasks">Other tasks</h2>

<h3 id="disable-a-module">Disable a module</h3>

<p>When a module is disabled in <code class="language-plaintext highlighter-rouge">app/etc/config.php</code>, its database schema configuration is no longer read on upgrade or install. As a result, subsequent system upgrades rebuild the database schema without the module’s tables, columns, or other elements.
Please note that the <code class="language-plaintext highlighter-rouge">db_schema_whitelist.json</code> file of disabled modules is still read during upgrades of installs, so the declarative schema system can perform the necessary operations.
Practically, this means that if you disable a module which uses declarative schema and run <code class="language-plaintext highlighter-rouge">bin/magento setup:upgrade</code>, <em>its database tables will be dropped</em> (see more details and discussion at  https://github.com/magento/magento2/issues/24926). Please consider using <code class="language-plaintext highlighter-rouge">setup:upgrade --safe-mode=1</code> in order to create a database backup after disabling a module and then eventually <code class="language-plaintext highlighter-rouge">setup:upgrade --data-restore=1</code> if you enable the module back and wish to restore from that backup.</p>


			</main>
			<footer class="content-footer">
				<button class="page-updated spectrum-ActionButton spectrum-ActionButton--quiet">
  <img class="spectrum-Icon spectrum-Icon--sizeS" src="https://devdocs.magento.com/assets/i/icons/time.svg" alt="Updated" />
  <time class="spectrum-ActionButton-label" id="last-modified-at" itemprop="dateModified" datetime="2020-04-20">
    Apr 20th, 2020
  </time>
</button>

			</footer>
		</div>
		<!-- /.content-wrap -->

		<div class="page-info">

  

</div>


	</section>
	<!-- /.content -->

</div> <!-- /.content-container -->


	</div>
	<!-- /.main-container -->
</div>
<!-- /#gl-wrapper -->

<!-- footer-->
<div class="page-footer">
  <div class="container">

    <div class="copyright-links">
      

<ul class="nav footer-links" role="menu">

  <li class="  " role="menuitem"><a href="https://github.com/magento/devdocs/blob/master/.github/CONTRIBUTING.md" class=" ">Become a Contributor</a></li>

  <li class="  " role="menuitem"><a href="https://glossary.magento.com/" class=" ">Glossary</a></li>

  <li class="  " role="menuitem"><a href="https://magento.com/legal/terms/privacy/" class=" ">Privacy Policy</a></li>

  <li class="  " role="menuitem"><a href="https://magento.com/legal/terms/" class=" ">Terms of Service</a></li>

  <li class="  " role="menuitem"><a href="https://magento.com/legal/licensing/" class=" ">License/Trademark FAQ</a></li>

  <li class="  " role="menuitem"><a href="../../release-notes/bk-release-notes.html" class=" ">Release Notes</a></li>

  <li class="  " role="menuitem"><a href="../../release-notes/packages-open-source.html" class=" ">Third-Party Licenses</a></li>

</ul>

    </div>

		<div class="copyright-date">&copy; 2020 Magento. All rights reserved.</div>

  </div>
</div>
<!-- / #footer -->


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="https://devdocs.magento.com/assets/js/app.min.js?ver=10"></script>
<script src="https://devdocs.magento.com/assets/js/editions.min.js?ver=10"></script>
<script src="https://devdocs.magento.com/assets/js/page-updated.min.js?ver=10"></script>





<script type="text/javascript">
    (function() {
        var didInit = false;
        function initMunchkin() {
            if(didInit === false) {
                didInit = true;
                Munchkin.init('585-GGD-959', {cookieAnon: false});
            }
        }
        var s = document.createElement('script');
        s.type = 'text/javascript';
        s.async = true;
        s.src = '//munchkin.marketo.net/munchkin.js';
        s.onreadystatechange = function() {
            if (this.readyState == 'complete' || this.readyState == 'loaded') {
                initMunchkin();
            }
        };
        s.onload = initMunchkin;
        document.getElementsByTagName('head')[0].appendChild(s);
    })();
</script>

<script type="text/javascript">_satellite.pageBottom();</script>



<script type="text/javascript" src="https://devdocs.magento.com/common/js/glossary-link-enhancer.js"></script>


</body>
</html>

